# Сообщения для коммуникации [сервера](../units/server.md) и [коннектора](../units/connector.md)

Обмен этими сообщениями происходит через сервис очереди (на данный момент [RabbitMQ](../units/rabbitmq.md)

Сообщения делятся на два типа:

- **Request** (реквест/запрос) - отправляется сервером, получается и обрабатывается коннектором
- **Response** (респонс/ответ) - отправляется коннектором, обрабатывается, соответственно, сервером

## Request

```json
{
    "nodeId": "UUID", // Идентификатор роутера/ноды, на который должен быть отправлен запрос
    "command": "v1/wifi/set-password",
    "args": {
        "password": "new-cool-password"
    } // Аргументы запроса
}
```

`command` - содержит [строку-команду из списка](../ipc/commands.md)

`args` - должен содержать аргументы, соответствующие команде, но валидироваться они будут только на стороне самого роутера.

Также Коннектор должен получить (средствами сервиса очереди) `CorrelationID`, который является идентификатором запроса, благодаря которому Сервер затем будет получать ответ от Коннектора из Очереди.

## Response

```json
{
    "requestError": "",
    "commandError": "",
    "data": {}
}
```

`requestError` должен отражать статус отправки запроса и получения ответа от ноды, т.е. если Запрос некорректен (например, указан ID неподключённой ноды), то такая ошибка будет отображена именно здесь. Но если на ноде при выполнении команды возникли проблемы (указан некорректный новый пароль, например), такая ошибка будет отражена в `commandError`.
Если ошибки нет, то `requestError` и `commandError` будут `nil` или `""`. Для уточнения/верификации ошибки имеет смысл переиспользовать строки с текстом ошибок и сравнивать их, при необходимости, _но лично я не уверен, в необходиомсти этого (просто залогируем ошибку и отправим `BadRequest` на фронт)_.

`data` содержит результат выполнения команды, должен валидироваться Сервером.
